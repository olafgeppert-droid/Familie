<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Familienringe – Stammbaum & Verwaltung</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<div id="loginOverlay" class="overlay">
  <div class="card login-card">
    <h1>🔐 Familienringe</h1>
    <p class="muted">Bitte Passwort eingeben, um die App zu öffnen.</p>
    <input id="pwd" type="password" placeholder="Passwort" autocomplete="current-password" />
    <button id="btnLogin" class="primary">Anmelden</button>
    <p id="loginMsg" class="error"></p>
  </div>
</div>

<header class="no-print glass topbar">
  <div class="brand">
    <span class="logo">💍</span>
    <div>
      <h2>Familienringe – Stammbaum</h2>
      <small class="muted">lokal gespeichert • exportierbar • druckbar</small>
    </div>
  </div>
  <div class="toolbar">
    <button id="btnAdd" class="primary">➕ Person</button>
    <button id="btnAddPartner">❤️ Partner</button>
    <input id="search" type="search" placeholder="Suche: Name oder Code" />
    <button id="btnSearch">🔎</button>
    <button id="btnShowAll">Alle</button>
    <span class="spacer"></span>
    <button id="btnDraw">🌳 Baum aktualisieren</button>
    <button id="btnExport">💾 Export</button>
    <label class="file-label">
      ⤴️ Import
      <input id="fileImport" type="file" accept="application/json" />
    </label>
    <button id="btnPrintTable">🖨️ Tabelle</button>
    <button id="btnPrintTree">🖨️ Baum</button>
  </div>
</header>

<main>
  <section id="paneTable" class="pane glass">
    <h3>📄 Personen – Tabelle</h3>
    <div class="table-wrap" id="tableWrap">
      <table id="peopleTable">
        <thead>
          <tr>
            <th>Personen-Code</th><th>Name</th><th>Geburtsdatum</th><th>Geburtsort</th>
            <th>Geschlecht</th><th>Generation</th><th>Eltern-Code</th><th>Partner-Code</th>
            <th>Geerbt von</th><th>Ring-Code</th><th class="no-print">Aktion</th>
          <th>Kommentar</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  <div class="hint">** Hat die Person keinen Familienwappenring, bitte im Kommentar vermerken.</div>
</section>

  <section id="paneTree" class="pane glass">
    <h3>🌳 Grafischer Stammbaum</h3>
    <div class="tree-wrap" id="treeWrap">
      <svg id="treeSvg" width="1600" height="1000" aria-label="Stammbaum"></svg>
    </div>
  <div class="hint">** Hat die Person keinen Familienwappenring, bitte im Kommentar vermerken.</div>
</section>
</main>

<!-- Dialog: neue Person -->
<dialog id="dlgAdd" class="glass dlg">
  <form method="dialog" id="formAdd">
    <h3>➕ Person hinzufügen</h3>
    <div class="grid">
      <label>Eltern-Code* <input name="parentCode" required placeholder="z. B. 1, 1A, 1A2" /></label>
      <label>Name <input name="name" /></label>
      <label>Geburtsdatum <input name="birthDate" placeholder="TT.MM.JJJJ" /></label>
      <label>Geburtsort <input name="birthPlace" /></label>
      <label>Geschlecht
        <select name="gender">
          <option value=""></option>
          <option>m</option><option>w</option><option>divers</option>
        </select>
      </label>
      <label>Kommentar <input name="note" /></label>
      <label>Vererbt? <select name="inherited"><option value="nein">nein</option><option value="ja">ja</option></select></label>
      <label>Geerbt von (Code) <input name="inheritedFrom" placeholder="z. B. 1A" /></label>
    </div>
    <p class="hint">* Der Ring-Code wird automatisch generiert: Kinder von „1“ → 1A,1B,1C…; tiefer → Ziffern anfügen; Partner → „x“-Suffix.</p>
    <menu>
      <button value="cancel">Abbrechen</button>
      <button id="dlgAddOk" value="ok" class="primary">Speichern</button>
    </menu>
  </form>
</dialog>

<!-- Dialog: Partner hinzufügen -->
<dialog id="dlgPartner" class="glass dlg">
  <form method="dialog" id="formPartner">
    <h3>❤️ Partner hinzufügen</h3>
    <div class="grid">
      <label>Code der Person* <input name="personCode" required placeholder="z. B. 1A" /></label>
      <label>Name des Partners <input name="name" /></label>
      <label>Geschlecht
        <select name="gender">
          <option value=""></option>
          <option>m</option><option>w</option><option>divers</option>
        </select>
      </label>
      <label>Kommentar <input name="note" /></label>
    </div>
    <menu>
      <button value="cancel">Abbrechen</button>
      <button id="dlgPartnerOk" value="ok" class="primary">Speichern</button>
    </menu>
  </form>
</dialog>

<footer class="no-print footer glass">
  <small>⚠️ Hinweis zum Code-System: Stammvater „1“. Kinder: 1A, 1B, 1C …; deren Kinder: 1A1, 1A2 …; Partner: „x“ (z. B. 1A ↔ 1Ax). Daten bleiben lokal (localStorage).</small>
</footer>

<script src="app.js"></script>
</body>
</html>
