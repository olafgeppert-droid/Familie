<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wappenringe der Familie GEPPERT</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer src="app.js"></script>
</head>
<body>
  <!-- Ribbon -->
  <header class="ribbon">
    <div class="ribbon-row row1">
      <div class="ribbon-left">
        <button id="btnNew" class="btn primary">➕ Neue Person</button>
        <button id="btnDeletePerson" class="btn">🗑️ Person löschen</button>
        <button id="btnImport" class="btn">📥 Import</button>
        <button id="btnExport" class="btn">📤 Export</button>
        <button id="btnPrint" class="btn">🖨️ Drucken</button>
        <button id="btnStats" class="btn">📊 Statistik</button>
        <button id="btnUndo" class="btn">↶ Undo</button>
        <button id="btnRedo" class="btn">↷ Redo</button>
        <button id="btnReset" class="btn danger">❗ Alle Daten löschen</button>
      </div>
      <div class="ribbon-right">
        <button id="btnHelp" class="btn help">❓ Hilfe</button>
      </div>
    </div>
    <div class="ribbon-row row2">
      <input id="search" type="search" placeholder="Personensuche (filtert die Tabelle)…" />
    </div>
  </header>

  <!-- Header Bar with Wappen -->
  <div class="titlebar">
    <img src="wappen.jpeg" alt="Wappen" class="wappen"/>
    <h1>Wappenringe der Familie GEPPERT</h1>
    <img src="wappen.jpeg" alt="Wappen" class="wappen"/>
  </div>

  <!-- Hinweis -->
  <p id="notice">Personen- und Ring-Code werden vom Programm vergeben. Sichere die Datenbank durch Export als JSON-Datei in deinem Backup-Verzeichnis.</p>

  <!-- Main -->
  <main class="layout">
    <section class="table-pane">
      <table id="peopleTable">
        <thead>
          <tr>
            <th>Gen</th>
            <th>Personen-Code</th>
            <th>Name</th>
            <th>Geschlecht</th>
            <th>Geburtsdatum</th>
            <th>Partner</th>
            <th>Vater</th>
            <th>Mutter</th>
            <th>Geerbt von Code</th>
            <th>Ring-Code</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section class="tree-pane">
      <div class="tree-toolbar">
        <span>Stammbaum</span>
      </div>
      <svg id="tree" width="100%" height="600" role="img" aria-label="Stammbaum"></svg>
    </section>
  </main>

  <!-- Dialogs -->
  <input type="file" id="filePicker" accept=".json,.csv" hidden />

  <dialog id="dlgNew" class="modal">
    <form method="dialog" id="formNew" class="form">
      <h3>Neue Person</h3>
      <div class="grid">
        <label>Vor- und Nachname*<br><input id="newName" required placeholder="z. B. Anna Muster"></label>
        <label>Geschlecht<br>
          <select id="newSex">
            <option value="">–</option>
            <option value="m">männlich</option>
            <option value="w">weiblich</option>
            <option value="d">divers</option>
          </select>
        </label>
        <label>Geburtsdatum (TT.MM.JJJJ)<br><input id="newDob" placeholder="z. B. 03.02.2001" inputmode="numeric"></label>
        <label>Vater (Code)<br><input id="newFather" placeholder="z. B. 1"></label>
        <label>Mutter (Code)<br><input id="newMother" placeholder="z. B. 1x"></label>
        <label>Partner-Codes (Komma-getrennt)<br><input id="newPartners" placeholder="z. B. 1x, 1A"></label>
        <label>Geerbt von Code (optional)<br><input id="newInherited" placeholder="z. B. 1B"></label>
      </div>
      <menu>
        <button value="cancel" id="btnCancelNew" class="btn">Abbrechen</button>
        <button id="btnSaveNew" class="btn primary" value="default">Speichern</button>
      </menu>
      <small>*Pflichtfeld. Abbrechen ist jederzeit möglich.</small>
    </form>
  </dialog>

  <dialog id="dlgDelete" class="modal">
    <form method="dialog" id="formDelete" class="form">
      <h3>Person löschen</h3>
      <p>Gib <b>Name</b> oder <b>Personen-Code</b> der zu löschenden Person ein.</p>
      <input id="deleteQuery" placeholder="Name oder Personen-Code">
      <menu>
        <button value="cancel" class="btn">Abbrechen</button>
        <button id="btnConfirmDelete" class="btn danger" value="default">Löschen</button>
      </menu>
    </form>
  </dialog>

  <dialog id="dlgExport" class="modal">
    <form method="dialog" id="formExport" class="form">
      <h3>Export</h3>
      <label><input type="checkbox" id="expJSON"> JSON</label>
      <label><input type="checkbox" id="expCSV"> CSV</label>
      <p class="muted">Tipp: Regelmäßig sichern. Auf iOS wird an „Teilen“ übergeben, sonst Download.</p>
      <menu>
        <button value="cancel" class="btn">Abbrechen</button>
        <button id="btnDoExport" class="btn primary" value="default">Export starten</button>
      </menu>
    </form>
  </dialog>

  <dialog id="dlgPrint" class="modal">
    <form method="dialog" id="formPrint" class="form">
      <h3>Drucken</h3>
      <label><input type="radio" name="printWhat" value="table" checked> Nur Tabelle</label><br>
      <label><input type="radio" name="printWhat" value="tree"> Nur Stammbaum</label><br>
      <label><input type="radio" name="printWhat" value="both"> Tabelle und Stammbaum</label>
      <menu>
        <button value="cancel" class="btn">Abbrechen</button>
        <button id="btnDoPrint" class="btn primary" value="default">PDF erzeugen</button>
      </menu>
    </form>
  </dialog>

  <!-- Help Modal (no dim background) -->
  <div id="helpOverlay" class="help-overlay" hidden>
    <div class="help-card">
      <button id="helpClose" aria-label="Hilfe schließen" class="close">×</button>
      <div id="helpContent" class="help-scroll"></div>
    </div>
  </div>

</body>
</html>
