/* Modern UI with improved dialog contrast for readability */
:root{
  --bg:#0b1220;
  --bg2:#0e1426;
  --glass:rgba(255,255,255,.08);
  --text:#eef3ff;
  --muted:#a8b2d1;
  --accent:#7aa2ff;
  --accent2:#9ef0ff;
  --danger:#ff6b6b;
  --ok:#19c37d;
  --shadow: 0 12px 30px rgba(0,0,0,.35);
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--text);
  background: radial-gradient(1200px 700px at 20% -10%, #20305e 0%, transparent 60%),
              radial-gradient(1000px 800px at 120% 20%, #08304d 0%, transparent 50%),
              linear-gradient(180deg, var(--bg), var(--bg2));}
h1,h2,h3{margin:0 0 10px}
h2{font-size:20px}
h3{font-size:18px}
small{color:var(--muted)}
.muted{color:var(--muted)}
.glass{background:var(--glass); backdrop-filter: blur(10px); border:1px solid rgba(255,255,255,.12); border-radius:14px; box-shadow: var(--shadow)}
.topbar{display:flex;align-items:center;justify-content:space-between;margin:12px;padding:12px 14px}
.brand{display:flex;gap:12px;align-items:center}
.logo{font-size:26px; filter: drop-shadow(0 3px 8px rgba(0,0,0,.6));}
.toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.toolbar input[type=search]{min-width:220px;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.12);color:var(--text)}
.file-label{display:inline-flex;gap:6px;align-items:center;padding:10px 12px;border-radius:10px;border:1px dashed rgba(255,255,255,.3);cursor:pointer}
.file-label input{display:none}
.spacer{flex:1}
button{padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.25);
  background:linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.06));
  box-shadow: inset 0 1px 0 rgba(255,255,255,.25), 0 6px 16px rgba(0,0,0,.35);
  color:var(--text); cursor:pointer}
button.primary{background:linear-gradient(180deg, var(--accent), #3d6fff); border-color:#8fb3ff}
button:hover{transform:translateY(-1px)}
button:active{transform:translateY(0)}
header .toolbar button{white-space:nowrap}

main{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin:12px}
.pane{padding:12px;min-height:420px}
.table-wrap{overflow:auto;max-height:58vh;border-radius:10px;border:1px solid rgba(255,255,255,.12)}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{border-bottom:1px solid rgba(255,255,255,.1);padding:8px 10px;text-align:left;vertical-align:top}
tr:nth-child(even){background:rgba(255,255,255,.03)}
.footer{margin:12px;padding:10px 14px}

.tree-wrap{overflow:auto;border-radius:10px;border:1px solid rgba(255,255,255,.12);max-height:58vh;background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01))}
svg text{font-size:12px;fill:#e7eeff}
.node{fill:url(#gradNode);stroke:#9fb8ff;stroke-width:1}
.link{stroke:#96a2c8;stroke-width:1.2}
.partner{stroke:#ff9f9f;stroke-dasharray:4 2}

dialog.dlg{border:none;padding:0;width:min(620px,96vw)}
dialog::backdrop{background:rgba(0,0,0,.6)}

/* Improved high-contrast dialog look */
.dlg-contrast{background:rgba(18,25,54,.96) !important;border:1px solid rgba(255,255,255,.22)}
dialog form{padding:16px;color:#f2f6ff}
dialog h3{margin-bottom:10px}
dialog .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.grid label{display:flex;flex-direction:column;font-size:13px;gap:6px;color:#eaf1ff}
.grid input, .grid select{padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.35);
  background:rgba(255,255,255,.14);color:#f7fbff}
.grid input::placeholder{color:#d8e3ff}
.hint{color:#d0daf5;margin:6px 0 0}
.hint.imp{color:#ffd7a1}
menu{display:flex;justify-content:flex-end;gap:8px;margin-top:12px}
.delete-btn{font-size:12px;border-color:rgba(255,0,0,.3);background:linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,0,0,.15))}
.delete-btn:hover{filter:brightness(1.05)}

.overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:radial-gradient(800px 500px at 50% -20%, rgba(122,162,255,.25), transparent 60%), rgba(10,15,40,.7);z-index:1000}
.login-card{padding:20px;max-width:380px;width:92%;text-align:center}
.login-card input{width:100%;margin-top:10px;margin-bottom:10px;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.12);color:var(--text)}
.error{color:#ffb3b3}

@media (max-width: 980px){
  main{grid-template-columns:1fr}
}

@media print{
  .no-print, .no-print *{display:none!important}
  body{background:#fff;color:#000}
  main{display:block;margin:0}
  .pane{border:none;background:#fff;box-shadow:none}
  .table-wrap, .tree-wrap{max-height:none}
  #treeSvg{width:100%;height:auto}
  @page { size: A4 portrait; margin: 12mm }
  body.print-tree-only @page { size: A4 landscape; margin: 10mm }
}
@media print{
  body.print-table-only #paneTree{display:none!important}
  body.print-tree-only #paneTable{display:none!important}
}
